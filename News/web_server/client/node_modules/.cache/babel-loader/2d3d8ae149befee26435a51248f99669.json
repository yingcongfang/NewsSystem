{"ast":null,"code":"var _jsxFileName = \"/Users/litianlun/Projects/News/web_server/client/src/SignUp/SignUpPage.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport SignUpForm from './SignUpForm';\n\nclass SignUpPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      errors: {},\n      user: {\n        email: '',\n        password: '',\n        confirm_password: ''\n      }\n    };\n    this.processForm = this.processForm.bind(this);\n    this.changeUser = this.changeUser.bind(this);\n  }\n\n  processForm(event) {\n    event.preventDefault();\n    const email = this.state.user.email;\n    const password = this.state.user.password;\n    const confirm_password = this.state.user.confirm_password;\n    console.log('email: ', email);\n    console.log('password: ', password);\n    console.log('confirm_password: ', confirm_password);\n\n    if (password !== confirm_password) {\n      return;\n    }\n\n    fetch('http://localhost:3000/auth/signup', {\n      method: 'POST',\n      cache: 'no-cache',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        email: this.state.user.email,\n        password: this.state.user.password\n      })\n    }).then(response => {\n      if (response.status === 200) {\n        this.setState({\n          errors: {}\n        }); // Change current url to login\n\n        this.props.history.push('/login');\n      } else {\n        response.json().then(function (json) {\n          console.log(json);\n          const errors = json.errors ? json.errors : {};\n          errors.summary = json.message;\n          console.log(this.state.errors);\n          this.setState({\n            errors\n          });\n        }.bind(this));\n      }\n    });\n  }\n\n  changeUser(event) {\n    const field = event.target.name;\n    const user = this.state.user;\n    user[field] = event.target.value;\n    this.setState({\n      user\n    });\n    console.log(this.state.user.password);\n\n    if (this.state.user.password !== this.state.user.confirm_password) {\n      const errors = this.state.errors;\n      errors.password = \"Password and Confirm Password don't match.\";\n      this.setState({\n        errors\n      });\n    } else {\n      const errors = this.state.errors;\n      errors.password = '';\n      this.setState({\n        errors\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(SignUpForm, {\n      onSubmit: this.processForm,\n      onChange: this.changeUser,\n      errors: this.state.errors,\n      user: this.state.user,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    });\n  }\n\n}\n\nexport default SignUpPage;","map":{"version":3,"sources":["/Users/litianlun/Projects/News/web_server/client/src/SignUp/SignUpPage.js"],"names":["React","Component","PropTypes","SignUpForm","SignUpPage","constructor","props","state","errors","user","email","password","confirm_password","processForm","bind","changeUser","event","preventDefault","console","log","fetch","method","cache","headers","body","JSON","stringify","then","response","status","setState","history","push","json","summary","message","field","target","name","value","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport SignUpForm from './SignUpForm';\n\nclass SignUpPage extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            errors: {},\n            user: {\n                email: '',\n                password: '',\n                confirm_password: ''\n            }\n        }\n\n        this.processForm = this.processForm.bind(this);\n        this.changeUser = this.changeUser.bind(this);\n    }\n\n    processForm(event) {\n        event.preventDefault();\n\n        const email = this.state.user.email;\n        const password = this.state.user.password;\n        const confirm_password = this.state.user.confirm_password;\n\n        console.log('email: ', email);\n        console.log('password: ', password);\n        console.log('confirm_password: ', confirm_password);\n\n        if (password !== confirm_password) {\n            return;\n        }\n\n        fetch('http://localhost:3000/auth/signup', {\n            method: 'POST',\n            cache: 'no-cache',\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                email: this.state.user.email,\n                password: this.state.user.password\n            })\n        }).then(response => {\n            if (response.status === 200) {\n                this.setState({\n                    errors: {}\n                })\n                // Change current url to login\n                this.props.history.push('/login');\n            } else {\n                response.json().then(function(json){\n                    console.log(json);\n                    const errors = json.errors? json.errors: {};\n                    errors.summary = json.message;\n                    console.log(this.state.errors);\n                    this.setState({\n                        errors\n                    })\n                }.bind(this));\n            }\n        })\n    }\n\n    changeUser(event) {\n        const field = event.target.name;\n        const user = this.state.user;\n        user[field] = event.target.value;\n\n        this.setState({user});\n        console.log(this.state.user.password);\n        if (this.state.user.password !== this.state.user.confirm_password) {\n            const errors = this.state.errors;\n            errors.password = \"Password and Confirm Password don't match.\";\n            this.setState({ errors });\n        } else {\n            const errors = this.state.errors;\n            errors.password = '';\n            this.setState({ errors });\n        }\n    }\n\n    render() {\n        return (\n            <SignUpForm \n                onSubmit={this.processForm}\n                onChange={this.changeUser}\n                errors={this.state.errors}\n                user={this.state.user}\n            />\n        );\n    }\n}\n\nexport default SignUpPage;"]},"metadata":{},"sourceType":"module"}