(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,a,t){e.exports=t(44)},30:function(e,a,t){},33:function(e,a,t){},34:function(e,a,t){},35:function(e,a,t){},37:function(e,a,t){},42:function(e,a,t){},43:function(e,a,t){},44:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),r=t(21),o=t.n(r),l=(t(30),t(3)),c=t(4),i=t(9),m=t(7),u=t(8),d=(t(31),t(32),t(11)),h=(t(33),t(10)),p=(t(34),t(35),function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"authenticateUser",value:function(e,a){localStorage.setItem("token",e),localStorage.setItem("email",a)}},{key:"isUserAuthenticated",value:function(){return null!==localStorage.getItem("token")}},{key:"deauthenticateUser",value:function(){var e=localStorage.getItem("token");console.log(e),localStorage.removeItem("token"),localStorage.removeItem("email")}},{key:"getToken",value:function(){return console.log(localStorage.getItem("token")),localStorage.getItem("token")}},{key:"getEmail",value:function(){return localStorage.getItem("email")}}]),e}()),g=function(e){function a(){return Object(l.a)(this,a),Object(i.a)(this,Object(m.a)(a).apply(this,arguments))}return Object(u.a)(a,e),Object(c.a)(a,[{key:"redirectToUrl",value:function(e){this.sendClickLog(),window.open(e,"_blank")}},{key:"sendClickLog",value:function(){var e="http://localhost:3000/news/userId/"+p.getEmail()+"/newsId/"+this.props.news.digest,a=new Request(encodeURI(e),{method:"POST",headers:{Authorization:"bearer "+p.getToken()},cache:"no-cache"});fetch(a)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"news-container",onClick:function(){return e.redirectToUrl(e.props.news.url)}},s.a.createElement("div",{className:"card horizontal"},s.a.createElement("div",{className:"card-image"},s.a.createElement("img",{src:this.props.news.urlToImage,alt:"news"})),s.a.createElement("div",{className:"card-stacked"},s.a.createElement("div",{className:"card-content"},s.a.createElement("span",{className:"card-title"},this.props.news.title),s.a.createElement("p",null,this.props.news.description)),s.a.createElement("div",{className:"card-action"},s.a.createElement("div",null,null!=this.props.news.source.id&&s.a.createElement("div",{className:"chip light-blue news-chip"},this.props.news.source.id),null!=this.props.news.reason&&s.a.createElement("div",{className:"chip light-green news-chip"},this.props.news.reason),null!=this.props.news.time&&s.a.createElement("div",{className:"chip amber news-chip"},this.props.news.time))))))}}]),a}(s.a.Component),w=t(22),v=t.n(w),E=function(e){function a(){var e;return Object(l.a)(this,a),(e=Object(i.a)(this,Object(m.a)(a).call(this))).state={news:null,pageNum:1,totalPages:1,loadedAll:!1},e.handleScroll=e.handleScroll.bind(Object(h.a)(e)),e}return Object(u.a)(a,e),Object(c.a)(a,[{key:"componentDidMount",value:function(){this.loadMoreNews(),this.loadMoreNews=v.a.debounce(this.loadMoreNews,1e3),window.addEventListener("scroll",this.handleScroll)}},{key:"handleScroll",value:function(){var e=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;window.innerHeight+e>=document.body.offsetHeight-50&&(console.log("Loading more news"),this.loadMoreNews())}},{key:"loadMoreNews",value:function(e){var a=this;if(!0!==this.state.loadedAll){var t="http://localhost:3000/news/userId/"+p.getEmail()+"/pageNum/"+this.state.pageNum,n=new Request(encodeURI(t),{method:"GET",headers:{Authorization:"bearer "+p.getToken()},cache:"no-cache"});console.log(n),fetch(n).then(function(e){return e.json()}).then(function(e){e&&0!==e.length||(console.log("No news"),a.setState({loadedAll:!0})),a.setState({news:a.state.news?a.state.news.concat(e):e,pageNum:a.state.pageNum+1})})}}},{key:"renderNews",value:function(){var e=this.state.news.map(function(e){return s.a.createElement("a",{className:"list-group-item",key:e.digest,href:"#"},s.a.createElement(g,{news:e}))});return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"list-group"},e))}},{key:"render",value:function(){return p.isUserAuthenticated()?this.state.news?s.a.createElement("div",null,this.renderNews()):s.a.createElement("div",null,s.a.createElement("div",{className:"progress"},s.a.createElement("div",{className:"indeterminate"}))):s.a.createElement("div",{className:"container"},"please login first")}}]),a}(s.a.Component),f=(t(37),t(12)),N=void 0,b=Object(d.f)(function(e){var a=e.children;e.history;return s.a.createElement("div",null,s.a.createElement("nav",{className:"nav-bar lighten-1"},s.a.createElement("div",{className:"nav-wrapper"},s.a.createElement(f.b,{to:"/",className:"brand-logo"},"\xa0\xa0NewsBoard"),s.a.createElement("ul",{id:"nav-mobile",className:"right"},p.isUserAuthenticated()?s.a.createElement("div",null,s.a.createElement("li",null,p.getEmail()),s.a.createElement("li",null,s.a.createElement("a",{href:"/",onClick:function(){p.deauthenticateUser(function(){return N.props.history.push("/logout")})}},"Log out"))):s.a.createElement("div",null,s.a.createElement("li",null,s.a.createElement(f.b,{to:"/login"},"Log in")),s.a.createElement("li",null,s.a.createElement(f.b,{to:"/signup"},"Sign up")))))),s.a.createElement("br",null),a)}),y=(t(42),function(e){var a=e.onSubmit,t=e.onChange,n=e.errors;e.user;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"card-panel login-panel"},s.a.createElement("form",{className:"col s12",action:"/",onSubmit:a},s.a.createElement("h4",{className:"center-align"},"Login"),n.summary&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.summary)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"email",type:"email",name:"email",onChange:t}),s.a.createElement("label",{htmlFor:"email"},"Email"))),n.email&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.email)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{className:"validate",id:"password",type:"password",name:"password",onChange:t}),s.a.createElement("label",{htmlFor:"password"},"Password"))),n.password&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.password)),s.a.createElement("div",{className:"row right-align"},s.a.createElement("input",{type:"submit",className:"waves-effect waves-light btn indigo lighten-1",value:"Log in"})),s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"right-align"}," New to Tap News?  ",s.a.createElement("a",{href:"/signup"},"Sign Up"))))))}),j=function(e){function a(e){var t;return Object(l.a)(this,a),(t=Object(i.a)(this,Object(m.a)(a).call(this,e))).state={errors:{},user:{email:"",password:""}},t.processForm=t.processForm.bind(Object(h.a)(t)),t.changeUser=t.changeUser.bind(Object(h.a)(t)),t}return Object(u.a)(a,e),Object(c.a)(a,[{key:"processForm",value:function(e){var a=this;e.preventDefault();var t=this.state.user.email,n=this.state.user.password;console.log("email:",t),console.log("password:",n),fetch("http://localhost:3000/auth/login",{method:"POST",cache:"no-cache",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})}).then(function(e){200===e.status?(a.setState({error:{}}),e.json().then(function(e){console.log(e),p.authenticateUser(e.token,t),a.props.history.replace("/")})):(console.log("login failed"),e.json().then(function(e){var t=e.errors?e.errors:{};t.summary=e.message,a.setState({errors:t})}))})}},{key:"changeUser",value:function(e){var a=e.target.name,t=this.state.user;t[a]=e.target.value,this.setState({user:t})}},{key:"render",value:function(){return s.a.createElement(y,{onSubmit:this.processForm,onChange:this.changeUser,errors:this.state.errors,user:this.state.user})}}]),a}(n.Component),k=(t(43),function(e){var a=e.onSubmit,t=e.onChange,n=e.errors;e.user;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"card-panel signup-panel"},s.a.createElement("form",{className:"col s12",action:"/",onSubmit:a},s.a.createElement("h4",{className:"center-align"},"Sign Up"),n.summary&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.summary)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"email",type:"email",name:"email",className:"validate",onChange:t}),s.a.createElement("label",{htmlFor:"email"},"Email"))),n.email&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.email)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"password",type:"password",name:"password",className:"validate",onChange:t}),s.a.createElement("label",{htmlFor:"password"},"Password"))),n.password&&s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"error-message"},n.password)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"input-field col s12"},s.a.createElement("input",{id:"confirm_password",type:"password",name:"confirm_password",className:"validate",onChange:t}),s.a.createElement("label",{htmlFor:"confirm_password"},"Confirm Password"))),s.a.createElement("div",{className:"row right-align"},s.a.createElement("input",{type:"submit",className:"waves-effect waves-light btn indigo lighten-1",value:"Sign Up"})),s.a.createElement("div",{className:"row"},s.a.createElement("p",{className:"right-align"}," Already have an account? ",s.a.createElement("a",{href:"/login"},"Login"))))))}),O=function(e){function a(e){var t;return Object(l.a)(this,a),(t=Object(i.a)(this,Object(m.a)(a).call(this,e))).state={errors:{},user:{email:"",password:"",confirm_password:""}},t.processForm=t.processForm.bind(Object(h.a)(t)),t.changeUser=t.changeUser.bind(Object(h.a)(t)),t}return Object(u.a)(a,e),Object(c.a)(a,[{key:"processForm",value:function(e){var a=this;e.preventDefault();var t=this.state.user.email,n=this.state.user.password,s=this.state.user.confirm_password;console.log("email: ",t),console.log("password: ",n),console.log("confirm_password: ",s),n===s&&fetch("http://localhost:3000/auth/signup",{method:"POST",cache:"no-cache",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})}).then(function(e){200===e.status?(a.setState({errors:{}}),a.props.history.push("/login")):e.json().then(function(e){console.log(e);var a=e.errors?e.errors:{};a.summary=e.message,console.log(this.state.errors),this.setState({errors:a})}.bind(a))})}},{key:"changeUser",value:function(e){var a=e.target.name,t=this.state.user;if(t[a]=e.target.value,this.setState({user:t}),console.log(this.state.user.password),this.state.user.password!==this.state.user.confirm_password){var n=this.state.errors;n.password="Password and Confirm Password don't match.",this.setState({errors:n})}else{var s=this.state.errors;s.password="",this.setState({errors:s})}}},{key:"render",value:function(){return s.a.createElement(k,{onSubmit:this.processForm,onChange:this.changeUser,errors:this.state.errors,user:this.state.user})}}]),a}(n.Component),S=function(e){function a(){return Object(l.a)(this,a),Object(i.a)(this,Object(m.a)(a).apply(this,arguments))}return Object(u.a)(a,e),Object(c.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(b,null,s.a.createElement(d.c,null,s.a.createElement(d.a,{path:"/login",component:j}),s.a.createElement(d.a,{path:"/signup",component:O}),s.a.createElement(d.a,{path:"/",component:E}))))}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(f.a,null,s.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[25,1,2]]]);
//# sourceMappingURL=main.e385f733.chunk.js.map